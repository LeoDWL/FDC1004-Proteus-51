C51 COMPILER V9.59.0.0   MAIN                                                              04/07/2022 23:24:26 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\keil5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\Hardware\src;.\Hardware\inc) DEBU
                    -G OBJECTEXTEND PRINT(.\Listings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <reg52.h>
   2          #include "LCD12864.h"
   3          #include "delay.h"
   4          #include "i2c.h"
   5          #include "FDC1004.h"
   6          
   7          //²ÎÊý¶¨Òå
   8          unsigned long Cap1 = 0;
   9          unsigned long Cap2 = 0;
  10          unsigned long Cap3 = 0;
  11          unsigned long Cap4 = 0;
  12          unsigned int Cap = 0;
  13          int Screen_Flag=0;//ÇåÆÁ±êÖ¾Î»
  14          float Moisture_Accuracy_Result = 0;//¼ÆËãµÃµ½µÄ¾«¶È
  15          float Set_Moisture_Accuracy = 0.02;//Éè¶¨µÄº¬Ë®ÂÊ¾«¶È
  16          float Set_Moisture_Result = 16.0;//Éè¶¨µÄº¬Ë®ÂÊ%
  17          
  18          sbit K1 = P3^3;//°¸¼þ°´ÏÂÊ±Îª0£¬ÏÔÊ¾¾«¶ÈºÍÊÇ·ñºÏ¸ñ
  19          sbit buzzer=P3^7;//·äÃùÆ÷Òý½Å
  20          
  21          void beep()//·äÃùÆ÷±¨¾¯
  22          {
  23   1        unsigned char a,b;
  24   1          for(b=19;b>0;b--)
  25   1              for(a=130;a>0;a--);
  26   1          buzzer=~buzzer;
  27   1          for(b=19;b>0;b--)
  28   1              for(a=130;a>0;a--);
  29   1          buzzer=1;
  30   1      }
  31          
  32          void main(void)
  33          {
  34   1          InitLCD();    //³õÊ¼»¯LCD12864
  35   1          digplaystart();//¿ª»ú¶¯»­
  36   1          Screen_Flag = 1;
  37   1          Config_FDC1004_Single(0x1C00,0x08);//ÅäÖÃFDC1004µçÈÝÍ¨µÀ1µ¥¶Ë²âÁ¿
  38   1          Config_FDC1004_Single(0x3C00,0x09);//ÅäÖÃFDC1004µçÈÝÍ¨µÀ2µ¥¶Ë²âÁ¿
  39   1          Config_FDC1004_Single(0x5C00,0x0A);//ÅäÖÃFDC1004µçÈÝÍ¨µÀ3µ¥¶Ë²âÁ¿
  40   1          Config_FDC1004_Single(0x7C00,0x0B);//ÅäÖÃFDC1004µçÈÝÍ¨µÀ4µ¥¶Ë²âÁ¿
  41   1          Triggering_FDC1004(0x0C);//´¥·¢²âÁ¿
  42   1          WaitFor_FDC1004(0x0C);
  43   1          Cap1 = ReadData_FDC1004(0x00);//¶ÁÈ¡µçÈÝÖµ
  44   1          Cap2 = ReadData_FDC1004(0x02);//¶ÁÈ¡µçÈÝÖµ
  45   1          Cap3 = ReadData_FDC1004(0x04);//¶ÁÈ¡µçÈÝÖµ
  46   1          Cap4 = ReadData_FDC1004(0x06);//¶ÁÈ¡µçÈÝÖµ
  47   1          while(1)
  48   1          {
  49   2              WaitFor_FDC1004(0x0C);
  50   2              Cap1 = ReadData_FDC1004(0x00);//¶ÁÈ¡µçÈÝÍ¨µÀ1µçÈÝÖµ
  51   2              Cap2 = ReadData_FDC1004(0x02);//¶ÁÈ¡µçÈÝÍ¨µÀ1µçÈÝÖµ
  52   2              Cap3 = ReadData_FDC1004(0x04);//¶ÁÈ¡µçÈÝÍ¨µÀ1µçÈÝÖµ
  53   2              Cap4 = ReadData_FDC1004(0x06);//¶ÁÈ¡µçÈÝÍ¨µÀ1µçÈÝÖµ
  54   2              //Cap = (Cap1+Cap2+Cap3+Cap4)/4;//¿ÉÓÃÓÚ²âÁ¿ËÄ¸öÍ¨µÀµÄÆ½¾ùÖµ
C51 COMPILER V9.59.0.0   MAIN                                                              04/07/2022 23:24:26 PAGE 2   

  55   2              
  56   2              //¼ì²âÊÇ·ñ°´ÏÂK1
  57   2              if(K1==0)//ÏÔÊ¾¾«¶ÈÒÔ¼°ÊÇ·ñºÏ¸ñ
  58   2              {
  59   3                  if(Screen_Flag != 2)//Èç¹ûScreen_Flag²»Îª2£¬ÔòËµÃ÷½øÈë¹ýÆÁ1£¬ÐèÒªÇåÆÁ
  60   3                  {
  61   4                      ClearScreenall();//ÇåÆÁ
  62   4                      digplayscreen2();//ÏÔÊ¾ÆÁ2
  63   4                  }
  64   3                  Screen_Flag = 2;//ËµÃ÷ÒÑ¾­½øÈëÆÁ2
  65   3                  
  66   3                  Cap_accuracy_Diplay(0,72,Cap2,Set_Moisture_Result);//µçÈÝ¾«¶ÈÏÔÊ¾
  67   3                  Moisture_Accuracy_Result = Moisture_accuracy_Diplay(3,88,Cap2,Set_Moisture_Result);//º¬Ë®ÂÊ¾«¶
             -ÈÏÔÊ¾£¬²¢·µ»ØºÏ¸ñÂÊ
  68   3                  if(Set_Moisture_Accuracy>=Moisture_Accuracy_Result)
  69   3                  {
  70   4                      digplayOK();//ÏÔÊ¾ºÏ¸ñ
  71   4                  }
  72   3                  else
  73   3                  {
  74   4                      digplayNOTOK();//ÏÔÊ¾²»ºÏ¸ñ
  75   4                      beep();//±¨¾¯
  76   4                  }
  77   3              }
  78   2              else
  79   2              {
  80   3                  if(Screen_Flag != 0)//Èç¹ûScreen_Flag²»Îª0£¬ÔòËµÃ÷½øÈë¹ýÆÁ2»òÕß¸Õ¿ª»ú£¬ÐèÒªÇåÆÁ
  81   3                  {
  82   4                      ClearScreenall();//ÇåÆÁ
  83   4                      digplayscreen1();//ÏÔÊ¾ÆÁ1
  84   4                  }
  85   3                  Screen_Flag = 0;
  86   3                  Cap_Cac_Diplay(3,48,Cap2);//µçÈÝÈÝÖµ¼ÆËã²¢ÏÔÊ¾
  87   3                  Moisture_Cac_Diplay(6,56,Cap2);//º¬Ë®ÂÊ¼ÆËã²¢ÏÔÊ¾£¬¸ù¾ÝµçÈÝ´óÐ¡£¬ÄâºÏµÃµ½º¬Ë®ÂÊµÄÊýÖµ²¢ÏÔÊ¾
  88   3              }
  89   2          }
  90   1      }                                                                                                    


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    411    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     32    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
